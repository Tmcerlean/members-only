<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <%- include('./partials/head'); %>
  <title>Members Only!</title>
</head>
<body class="container">

  <header>
    <%- include('./partials/header'); %>
  </header>

  <main>
    <div class="jumbotron">
      <% if (user) {%>
        <h1>Welcome Back <%= user.username %></h1>
        <a href="/log-out">LOG OUT</a>
        <% for(let i=0; i< result.length; i++){
          if(currentUser){ 
              if(currentUser.member_status){ %>
                  
                  <div class='card'>
                    <div class="text-primary bg-warning p-2"><span>Title:</span>    <%=result[i].title %></div><br/>
                    <div class="p-2"><span>Message:</span>    <%=result[i].body %></div><br/>
                    <div class="p-2"><span>By:</span>    <%=result[i].user.username %></div><br/>
                    <div class="p-2"><span>Date:</span>    <%=result[i].timestamp %></div><br/>
                    <div> 
                      <form method="POST" action=" " class="p-2">
                          <input type="hidden" value="<%=result[i]._id %>" name='delete' id='delete' />
                          <button>Delete Post</button>
                      </form>
                    </div>
                  </div>
                 
                  <br/>
              
            <%  }else{ %>
              
              <div class='card'>
                  <div class="text-primary bg-warning p-2"><span>Title:</span>    <%=result[i].title %></div><br/>
                  <div class="p-2"><span>Message:</span>    <%=result[i].body %></div><br/>
                  <div class="p-2"><span>By:</span>    <%=result[i].user.username %></div><br/>
                  <div class="p-2"><span>Date:</span>    <%=result[i].timestamp %></div><br/>
              </div>
              <br/>
      <%   } }
          else{ %>
              <div class="card">
                  <div class="text-primary bg-warning p-2"><span>Title:</span>    <%=result[i].title %></div><br/>
                  <div class="p-2"><span>Message:</span>    <%=result[i].body %></div><br/>
                  <div class="p-2"><span>By:</span>    Anonymous</div>
                  <div class="p-2"><span>Date:</span>    <%=result[i].timestamp %></div><br/>
                  <br/>
              </div>
              <br/> 
       <%   }
      }  %>
      <% } else { %>
        <h1>Please Log In</h1>
        <form action="/log-in" method="POST">
          <div class="form-group">
            <label for="username">Username</label>
            <input name="username" class="form-control" placeholder="Username" type="text" />
          </div>
          <div class="form-group">
            <label for="password">Password</label>
            <input name="password" class="form-control" type="Password" />
          </div>
          <button>Log In</button>
        </form>
        <hr>
        <h2>Posts</h2>
        <% for(let i=0; i< result.length; i++){
          if(currentUser){ 
              if(currentUser.member_status){ %>
                  
                  <div class='container'>
                      <div><span>Title:</span>    <%=result[i].title %></div><br/>
                      <div><span>Message:</span>    <%=result[i].body %></div><br/>
                      <div><span>By:</span>    <%=result[i].user.username %></div><br/>
                      <div><span>Date:</span>    <%=result[i].timestamp %></div><br/>
                      <div> 
                        <form method="POST" action=" ">
                            <input type="hidden" value="<%=result[i]._id %>" name='delete' id='delete' />
                            <button>Delete Post</button>
                        </form>
                      </div>
                  </div>
                 
                  <br/>
              
            <%  }else{ %>
              
              <div class='container'>
                  <div><span>Title:</span>    <%=result[i].title %></div><br/>
                  <div><span>Message:</span>    <%=result[i].body %></div><br/>
                  <div><span>By:</span>    <%=result[i].user.username %></div><br/>
                  <div><span>Date:</span>    <%=result[i].timestamp %></div><br/>
              </div>
              <br/>
      <%   } }
          else{ %>
              <div class="card">
                  <div class="text-primary bg-warning p-2"><span>Title:</span>    <%=result[i].title %></div><br/>
                  <div class="p-2"><span>Message:</span>    <%=result[i].body %></div><br/>
                  <div class="p-2"><span>By:</span>    Anonymous</div>
                  <div class="p-2"><span>Date:</span>    <%=result[i].timestamp %></div><br/>
                  <br/>
              </div>
              <br/> 
       <%   }
      }  %>
      <%}%>
    </div>
  </main>

  <footer>
    <%- include('./partials/footer'); %>
  </footer>

</body>
</html>